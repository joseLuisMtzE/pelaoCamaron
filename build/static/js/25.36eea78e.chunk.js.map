{"version":3,"sources":["shared/Alert.js","../node_modules/@ant-design/icons-svg/es/asn/DollarCircleOutlined.js","../node_modules/@ant-design/icons/es/icons/DollarCircleOutlined.js","components/Discounts/Discount.jsx"],"names":["alertError","message","Swal","fire","icon","title","text","alertSuccess","DollarCircleOutlined","props","ref","React","AntdIcon","Object","assign","DollarCircleOutlinedSvg","displayName","Discount","orderId","total","useState","visible","state","setState","porDiscount","setporDiscount","subTotal","setSubTotal","id","Form","useForm","form","handleOk","sendDiscount","handleCancel","setFieldsValue","porcentaje","useEffect","discount","a","makeRequest","pago","porcentajeDescuento","response","console","log","status","error","shape","className","onClick","onOk","onCancel","footer","key","type","danger","name","initialValues","remember","Item","label","rules","required","whitespace","validator","_","value","Promise","resolve","reject","onChange","e","target"],"mappings":"+GAAA,yFAEW,SAASA,EAAWC,GACvBC,IAAKC,KAAK,CACNC,KAAM,QACNC,MAAM,QACNC,KAAML,IAKP,SAASM,EAAaN,GACzBC,IAAKC,KAAK,CACNC,KAAM,UACNC,MAAO,mBACPC,KAAML,M,gJCbHO,EADY,CAAE,KAAQ,CAAE,IAAO,MAAO,MAAS,CAAE,QAAW,gBAAiB,UAAa,SAAW,SAAY,CAAC,CAAE,IAAO,OAAQ,MAAS,CAAE,EAAK,+zBAAm0B,KAAQ,gBAAiB,MAAS,Y,SCKngCA,EAAuB,SAA8BC,EAAOC,GAC9D,OAAOC,gBAAoBC,IAAUC,OAAOC,OAAO,GAAIL,EAAO,CAC5DC,IAAKA,EACLN,KAAMW,MAIVP,EAAqBQ,YAAc,uBACpBL,mBAAiBH,GCgJjBS,UAtJE,SAAC,GAAwB,IAAtBC,EAAqB,EAArBA,QAASC,EAAY,EAAZA,MAAY,EACbC,mBAAS,CAAEC,SAAS,IADP,mBAChCC,EADgC,KACzBC,EADyB,OAEDH,mBAAS,GAFR,mBAEhCI,EAFgC,KAEnBC,EAFmB,OAIPL,mBAAS,GAJF,mBAIhCM,EAJgC,KAItBC,EAJsB,KAKjCC,EAAKV,EAL4B,EAQxBW,IAAKC,UAAbC,EARgC,oBAiBjCC,EAAW,WACfT,EAAS,CAAEF,SAAS,IACpBY,EAAaT,IAGTU,EAAe,WACnBX,EAAS,CAAEF,SAAS,IACpBI,EAAe,GACfM,EAAKI,eAAe,CAAEC,WAAY,KAgBpCC,qBAAU,WAHRV,EADkBR,EAKXK,EANwBL,EAAS,OAQvC,CAACK,IAqBJ,IAAMS,EAAY,uCAAG,WAAOK,GAAP,eAAAC,EAAA,+EAEIC,YAAY,MAAD,kBAAmBZ,GAAM,CACvDa,KAAM,CACJC,oBAAqBJ,KAJR,OAEbK,EAFa,OAOjBC,QAAQC,IAAIF,GACRA,GAAYA,EAASG,QAA8B,MAApBH,EAASG,OAC1CvC,YAAa,oCAEbP,YAAW,yCAEbyB,EAAe,GACfM,EAAKI,eAAe,CAAEC,WAAY,IAdjB,kDAgBjBQ,QAAQC,IAAR,MACA7C,YAAW,KAAI+C,OAjBE,0DAAH,sDAqBlB,OACE,6BACE,6BACE,kBAAC,IAAD,CAAQC,MAAM,SAASC,UAAU,eAAeC,QA9EpC,WAChB3B,EAAS,CACPF,SAAS,MA6EL,kBAAC,EAAD,CAAsB4B,UAAU,iBAElC,gDAIA,kBAAC,IAAD,CACE5C,MAAM,YACNgB,QAASC,EAAMD,QACf8B,KAAMnB,EACNoB,SAAUlB,EACVmB,OAAQ,CACN,kBAAC,IAAD,CAAQC,IAAI,OAAOJ,QAAShB,EAAcqB,KAAK,UAAUC,QAAM,GAA/D,YAGA,kBAAC,IAAD,CAAQF,IAAI,SAASC,KAAK,UAAUL,QAASlB,GAA7C,aAKF,yBAAKiB,UAAU,cACb,kBAAC,IAAD,CACElB,KAAMA,EACN0B,KAAK,YACLC,cAAe,CAAEC,UAAU,IAE3B,kBAAC,IAAKC,KAAN,CACEH,KAAK,aACLI,MAAM,2BACNC,MAAO,CACL,CACEC,UAAU,EACV9D,QAAS,2CACT+D,YAAY,EACZC,UAAW,SAACC,EAAGC,GAAJ,OACTA,GAAS,GAAKA,GAAS,IACnBC,QAAQC,UACRD,QAAQE,OAAO,4CAIzB,kBAAC,IAAD,CACEf,KAAK,SACLgB,SAxGU,SAAAC,GACxB/C,EAAe+C,EAAEC,OAAON,QAwGVA,MAAO3C,MAIb,4BACA,8CAAoBL,GACpB,6BACA,4BACA,2CAAiBO","file":"static/js/25.36eea78e.chunk.js","sourcesContent":["import Swal from 'sweetalert2';\r\n\r\n    export function alertError(message){\r\n        Swal.fire({\r\n            icon: 'error',\r\n            title:'Error' ,\r\n            text: message\r\n           // footer: '<a href>Why do I have this issue?</a>'\r\n        })\r\n    }\r\n\r\n    export function alertSuccess(message){\r\n        Swal.fire({\r\n            icon: 'success',\r\n            title: 'Proceso exitoso!',\r\n            text: message\r\n           // footer: '<a href>Why do I have this issue?</a>'\r\n        })\r\n    }\r\n\r\n \r\n","// This icon file is generated automatically.\nvar DollarCircleOutlined = { \"icon\": { \"tag\": \"svg\", \"attrs\": { \"viewBox\": \"64 64 896 896\", \"focusable\": \"false\" }, \"children\": [{ \"tag\": \"path\", \"attrs\": { \"d\": \"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372zm47.7-395.2l-25.4-5.9V348.6c38 5.2 61.5 29 65.5 58.2.5 4 3.9 6.9 7.9 6.9h44.9c4.7 0 8.4-4.1 8-8.8-6.1-62.3-57.4-102.3-125.9-109.2V263c0-4.4-3.6-8-8-8h-28.1c-4.4 0-8 3.6-8 8v33c-70.8 6.9-126.2 46-126.2 119 0 67.6 49.8 100.2 102.1 112.7l24.7 6.3v142.7c-44.2-5.9-69-29.5-74.1-61.3-.6-3.8-4-6.6-7.9-6.6H363c-4.7 0-8.4 4-8 8.7 4.5 55 46.2 105.6 135.2 112.1V761c0 4.4 3.6 8 8 8h28.4c4.4 0 8-3.6 8-8.1l-.2-31.7c78.3-6.9 134.3-48.8 134.3-124-.1-69.4-44.2-100.4-109-116.4zm-68.6-16.2c-5.6-1.6-10.3-3.1-15-5-33.8-12.2-49.5-31.9-49.5-57.3 0-36.3 27.5-57 64.5-61.7v124zM534.3 677V543.3c3.1.9 5.9 1.6 8.8 2.2 47.3 14.4 63.2 34.4 63.2 65.1 0 39.1-29.4 62.6-72 66.4z\" } }] }, \"name\": \"dollar-circle\", \"theme\": \"outlined\" };\nexport default DollarCircleOutlined;\n","// GENERATE BY ./scripts/generate.ts\n// DON NOT EDIT IT MANUALLY\nimport * as React from 'react';\nimport DollarCircleOutlinedSvg from \"@ant-design/icons-svg/es/asn/DollarCircleOutlined\";\nimport AntdIcon from '../components/AntdIcon';\n\nvar DollarCircleOutlined = function DollarCircleOutlined(props, ref) {\n  return React.createElement(AntdIcon, Object.assign({}, props, {\n    ref: ref,\n    icon: DollarCircleOutlinedSvg\n  }));\n};\n\nDollarCircleOutlined.displayName = 'DollarCircleOutlined';\nexport default React.forwardRef(DollarCircleOutlined);","import React, { useState, useEffect } from 'react';\r\nimport { Modal, Button, Input, Form } from 'antd';\r\nimport { makeRequest } from '../../shared/ApiWrapper';\r\nimport { alertError, alertSuccess } from '../../shared/Alert';\r\n\r\n//icon\r\nimport { DollarCircleOutlined } from '@ant-design/icons';\r\n\r\nconst Discount = ({ orderId, total }) => {\r\n  const [state, setState] = useState({ visible: false });\r\n  const [porDiscount, setporDiscount] = useState(0);\r\n  // const [total, setTotal] = useState(0);\r\n  const [subTotal, setSubTotal] = useState(0);\r\n  const id = orderId;\r\n\r\n  //5ecc7e7ef1dd0a0004a6b938\r\n  const [form] = Form.useForm();\r\n\r\n  //funciones para la modal\r\n  const showModal = () => {\r\n    setState({\r\n      visible: true\r\n    });\r\n  };\r\n\r\n  const handleOk = () => {\r\n    setState({ visible: false });\r\n    sendDiscount(porDiscount);\r\n  };\r\n\r\n  const handleCancel = () => {\r\n    setState({ visible: false });\r\n    setporDiscount(0);\r\n    form.setFieldsValue({ porcentaje: 0 });\r\n  };\r\n\r\n  //Guardado del valor del descuento\r\n  const porDiscountChange = e => {\r\n    setporDiscount(e.target.value);\r\n    // console.log(porDiscount);\r\n  };\r\n\r\n  //Cambio del subtotal dependiendo el porcentaje de descuento\r\n  const result = discount => {\r\n    const porcentaje = (discount * total) / 100;\r\n    const resultado = total - porcentaje;\r\n    setSubTotal(resultado);\r\n  };\r\n\r\n  useEffect(() => {\r\n    result(porDiscount);\r\n    // console.log(orderId);\r\n  }, [porDiscount]);\r\n\r\n  /* useEffect(() => {\r\n    // getTotal();\r\n    console.log('Re render');\r\n  }, []);*/\r\n\r\n  //peticion para obtener el total\r\n  // const getTotal = async () => {\r\n  //   try {\r\n  //     let response = await makeRequest('GET', `ordenes/${id}`);\r\n  //     let data = response.data.data.pago.precioTotal;\r\n  //     setTotal(data);\r\n  //     console.log(data);\r\n  //     //return data;\r\n  //   } catch (err) {\r\n  //     console.log(err);\r\n  //   }\r\n  // };\r\n\r\n  //peticion para hacer la actualizacion del porcentaje descuento\r\n  const sendDiscount = async (discount) => {\r\n    try {\r\n      let response = await makeRequest('PUT', `ordenes/${id}`, {\r\n        pago: {\r\n          porcentajeDescuento: discount,\r\n        },\r\n      });\r\n      console.log(response);\r\n      if (response && response.status && response.status === 200) {\r\n        alertSuccess('Descuento aplicado correctamente');\r\n      } else {\r\n        alertError('Hubo un error al aplicar el descuento');\r\n      }\r\n      setporDiscount(0);\r\n      form.setFieldsValue({ porcentaje: 0 });\r\n    } catch (err) {\r\n      console.log(err);\r\n      alertError(err.error);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <div>\r\n        <Button shape=\"circle\" className=\"discount-btn\" onClick={showModal}>\r\n          <DollarCircleOutlined className=\"normal-size\" />\r\n        </Button>\r\n        <p>Agregar descuento</p>\r\n        {/* <Button type=\"primary\" onClick={showModal}>\r\n          Descuento\r\n        </Button> */}\r\n        <Modal\r\n          title=\"Descuento\"\r\n          visible={state.visible}\r\n          onOk={handleOk}\r\n          onCancel={handleCancel}\r\n          footer={[\r\n            <Button key=\"back\" onClick={handleCancel} type=\"primary\" danger>\r\n              Cancelar\r\n            </Button>,\r\n            <Button key=\"submit\" type=\"primary\" onClick={handleOk}>\r\n              Aceptar\r\n            </Button>\r\n          ]}\r\n        >\r\n          <div className=\"Descuentos\">\r\n            <Form\r\n              form={form}\r\n              name=\"Discounts\"\r\n              initialValues={{ remember: true }}\r\n            >\r\n              <Form.Item\r\n                name=\"porcentaje\"\r\n                label=\"% Porcentaje a Descontar\"\r\n                rules={[\r\n                  {\r\n                    required: true,\r\n                    message: 'Por favor ingresa un porcentaje correcto',\r\n                    whitespace: true,\r\n                    validator: (_, value) =>\r\n                      value >= 0 && value <= 100\r\n                        ? Promise.resolve()\r\n                        : Promise.reject('El porcentaje debe ser entre 0 y 100')\r\n                  }\r\n                ]}\r\n              >\r\n                <Input\r\n                  type=\"number\"\r\n                  onChange={porDiscountChange}\r\n                  value={porDiscount}\r\n                />\r\n              </Form.Item>\r\n            </Form>\r\n            <p></p>\r\n            <p>Total anterior ${total}</p>\r\n            <hr />\r\n            <p></p>\r\n            <p>Total nuevo ${subTotal}</p>\r\n          </div>\r\n        </Modal>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Discount;\r\n"],"sourceRoot":""}