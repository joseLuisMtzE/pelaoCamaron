(this.webpackJsonpposrestfront=this.webpackJsonpposrestfront||[]).push([[24],{413:function(e,a,t){"use strict";t.d(a,"a",(function(){return c})),t.d(a,"b",(function(){return o}));var n=t(31),r=t.n(n);function c(e){r.a.fire({icon:"error",title:"Error",text:e})}function o(e){r.a.fire({icon:"success",title:"Proceso exitoso!",text:e})}},429:function(e,a,t){e.exports=t.p+"static/media/background.7eab2424.png"},535:function(e,a,t){"use strict";t.r(a),t.d(a,"default",(function(){return _}));var n=t(43),r=t(6),c=t.n(r),o=t(13),l=t(26),s=t(0),i=t.n(s),u=t(420),m=t(421),d=t(411),p=t(410),b=t(517),f=t(534),v=t(16),E=t(463),O=t(464),g=t(447),h=t(60),j=t(479),y=t.n(j),x=t(10),M=t(413),w=p.a.confirm;function k(e){var a=e.table,t=e.deleteTable,n=e.editTablesRequest,r=Object(s.useState)(!1),u=Object(l.a)(r,2),m=u[0],j=u[1],k=Object(s.useState)(""),N=Object(l.a)(k,2),D=N[0],T=N[1],C=Object(s.useState)(!1),S=Object(l.a)(C,2),_=S[0],R=S[1],I=Object(s.useState)(0),P=Object(l.a)(I,2),z=P[0],L=P[1];Object(s.useEffect)((function(){"Reservada"===a.estado&&R(!0)}),[a.estado]);var A=function(){var e=Object(o.a)(c.a.mark((function e(){var t,n,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=new FormData(document.getElementById(a._id)),(n=Object.fromEntries(t)).tipoOrden=D,console.log(n),localStorage.setItem("domicilio",JSON.stringify(n)),localStorage.setItem("noMesa",a.noMesa),"Local"!==D){e.next=11;break}return e.next=9,H(n);case 9:r=e.sent,console.log(r);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),H=function(){var e=Object(o.a)(c.a.mark((function e(t){var n,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(x.c)("POST","mesas/".concat(a._id,"/ordenes"),{numPersonas:t.numPersonas,tipoOrden:t.tipoOrden,observaciones:t.observaciones});case 3:return 201===(n=e.sent).status?(console.log("Orden creada correctamente"),window.history.replaceState(null,null,"http://localhost:3000/agregar-platillos/"+n.data.data._id)):(window.location.href="/mesas",Object(M.a)("Hubo un error al crear la orden")),r=n.data.data,e.abrupt("return",r);case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0),window.location.href="/mesas",Object(M.a)("Hubo un error al crear la orden");case 14:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(a){return e.apply(this,arguments)}}(),F="Mesa ".concat(a.noMesa),q="Mesa ".concat(a.noMesa," - ").concat(a.estado);return i.a.createElement("div",null,i.a.createElement(b.a,{size:"small",onClick:function(){j(!0)},title:F,className:"card"},i.a.createElement("p",null,"Mesa ".concat(a.estado)),"Disponible"===a.estado?i.a.createElement("div",{className:"disponible"}):"Ocupada"===a.estado?i.a.createElement("div",{className:"ocupada"}):i.a.createElement("div",{className:"reservada"})),i.a.createElement(p.a,{title:q,visible:m,onOk:function(){j(!1)},onCancel:function(){j(!1)},footer:"Disponible"===a.estado?[i.a.createElement("form",{id:a._id},i.a.createElement("strong",null,"Abrir cuenta"),i.a.createElement("p",null,"\xbfCu\xe1ntas personas?"),i.a.createElement(f.a,{placeholder:"0",name:"numPersonas",onChange:function(e){L(e||0)}}),i.a.createElement("p",null,"Tipo de orden: "),i.a.createElement(d.a,{required:!0,name:"tipoOrden",options:[{value:"Local",label:"Local"},{value:"Domicilio",label:"Domicilio"}],onChange:function(e){e[0]?T(e[0]):T("")},placeholder:"Tipo de orden..."}),i.a.createElement("p",null,"Observaciones: "),i.a.createElement(y.a,{name:"observaciones",placeholder:"Agregar observaciones..."}),i.a.createElement(v.a,{key:"submit",type:"primary",className:"margin"},""!==D&&0!==z&&i.a.createElement(h.b,{onClick:A,to:{pathname:"Local"===D?"/agregar-platillos/:id":"/home-delivery/",state:{idMesa:a._id}}},"Abrir cuenta")))]:null},"Ocupada"!==a.estado?i.a.createElement("div",null,i.a.createElement("strong",null,"Editar"),i.a.createElement("br",null),i.a.createElement(d.a,{options:_?[{value:"Disponible",label:"Disponible"},{value:"Reservada",label:"Reservada"}]:[{value:"Disponible",label:"Disponible"},{value:"No Disponible",label:"No Disponible"},{value:"Reservada",label:"Reservada"}],onChange:function(e){e[0]&&(a.estado=e[0]),"Reservada"!==e[0]?(n(a._id,a.noMesa,a.estado),R(!1),j(!1)):R(!0)},placeholder:"Estado de la mesa..."}),"Due\xf1o"===Object(x.a)()?i.a.createElement(v.a,{onClick:function(){j(!1),w({title:"\xbfQuieres eliminar la mesa ".concat(a.noMesa,"?"),icon:i.a.createElement(E.a,null),content:"La mesa ".concat(a.noMesa," ser\xe1 eliminada de la lista de mesas."),okText:"Eliminar",cancelText:"Cancelar",okType:"danger",onOk:function(){t(a.noMesa,a._id)},onCancel:function(){}})},type:"primary",danger:!0},i.a.createElement(O.a,null)):null,_&&i.a.createElement("form",{id:a._id},i.a.createElement(y.a,{name:"detalles",placeholder:"Observaciones de la reservaci\xf3n...",className:"margin-top"}),i.a.createElement(v.a,{className:"margin-top reservar-btn",onClick:function(){var e=new FormData(document.getElementById(a._id)),t=Object.fromEntries(e);void 0!==t.detalles&&""!==t.detalles||(t.detalles=" "),n(a._id,a.noMesa,a.estado,t.detalles),j(!1)}},"Reservar"))):i.a.createElement("div",null,i.a.createElement("strong",null,"Orden en proceso..."),i.a.createElement("br",null),i.a.createElement(g.a,null),i.a.createElement("br",null),i.a.createElement(v.a,{type:"primary",className:"margin"},i.a.createElement(h.b,{onClick:function(){localStorage.setItem("noMesa",a.noMesa),localStorage.setItem("mesaID",a._id)},to:{pathname:"/ver-orden/:id"}},"Ver orden")))))}var N=t(202),D=t(465);function T(e){var a=e.addTable,t=Object(s.useState)(!1),n=Object(l.a)(t,2),r=n[0],c=n[1];return i.a.createElement("div",null,i.a.createElement(b.a,{onClick:function(){c(!0)},size:"small",className:"card"},i.a.createElement(v.a,{type:"link",size:"large",icon:i.a.createElement(D.a,{className:"big-size"}),className:"add-btn-2"})),i.a.createElement(p.a,{title:"Nueva mesa",visible:r,onCancel:function(){c(!1)},footer:null},i.a.createElement("form",{id:"form"},i.a.createElement("p",null,"N\xfamero de mesa:"),i.a.createElement(N.a,{onPressEnter:function(e){return e.preventDefault()},name:"noMesa",size:"large",style:{width:"25%"}}),i.a.createElement("br",null),i.a.createElement(v.a,{type:"primary",onClick:function(){var e=new FormData(document.getElementById("form")),t=Object.fromEntries(e);t.estado="Disponible",c(!1),a(t)},className:"margin"},"Agregar"))))}var C=t(429),S=t.n(C);function _(){var e=Object(s.useState)([]),a=Object(l.a)(e,2),t=a[0],r=a[1],p=Object(s.useState)([]),b=Object(l.a)(p,2),f=b[0],v=b[1],E=Object(s.useState)("Todas"),O=Object(l.a)(E,2),h=O[0],j=O[1],y=function(){var e=Object(o.a)(c.a.mark((function e(){var a,t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(x.c)("GET","mesas?isActive=true&&limit=100");case 3:return a=e.sent,t=a.data.data,e.abrupt("return",t);case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),w=function(){var e=Object(o.a)(c.a.mark((function e(a){var o,l,s;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(a),e.prev=1,e.next=4,Object(x.c)("POST","mesas",{noMesa:a.noMesa});case 4:return o=e.sent,l=o.data.data,201===o.status?((s=Object(n.a)(t)).push(l),r(s),Object(M.b)("Mesa ".concat(a.noMesa," creada correctamente"))):Object(M.a)("Hubo un error al crear la mesa"),e.abrupt("return",l);case 10:e.prev=10,e.t0=e.catch(1),console.log(e.t0),Object(M.a)("La mesa n\xfamero ".concat(a.noMesa," ya existe. Intenta con otro n\xfamero"));case 14:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(a){return e.apply(this,arguments)}}(),N=function(){var e=Object(o.a)(c.a.mark((function e(a){var t,n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(x.c)("DELETE","mesas/".concat(a));case 3:return 204===(t=e.sent).status?Object(M.b)("Mesa borrada correctamente"):Object(M.a)("Hubo un error al borrar la Mesa"),n=t.data.data,e.abrupt("return",n);case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(a){return e.apply(this,arguments)}}(),D=function(){var e=Object(o.a)(c.a.mark((function e(a,t,n,r){var o,l;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(x.c)("PATCH","mesas/".concat(a),{estado:n,reservaciones:{detalles:r}});case 3:return 200===(o=e.sent).status?void 0===r?Object(M.b)("Mesa editada correctamente"):Object(M.b)("Mesa reservada correctamente"):Object(M.a)("Hubo un error al editar la mesa"),l=o.data.data,e.abrupt("return",l);case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(a,t,n,r){return e.apply(this,arguments)}}();Object(s.useEffect)((function(){(function(){var e=Object(o.a)(c.a.mark((function e(){var a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y();case 2:a=e.sent,console.log(a),a&&r(a);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]),Object(s.useEffect)((function(){var e="Todas"!==h?t.filter((function(e){return e.estado===h})):t;v(e)}),[t,h]);var C=function(){var e=Object(o.a)(c.a.mark((function e(a){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w(a);case 2:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}(),_=function(e,a){var c=Object(n.a)(t);c.forEach((function(a,t){a.noMesa===e&&c.splice(t,1)})),r(c),N(a)};return i.a.createElement(u.a,null,i.a.createElement(m.a,{md:24,xs:24},i.a.createElement("img",{src:S.a,alt:"bg",className:"bg-img"}),i.a.createElement("header",{className:"header"},i.a.createElement("h1",{className:"h1"},"Mesas"))),i.a.createElement(m.a,{md:24,xs:24},i.a.createElement(m.a,{xs:12},i.a.createElement(d.a,{size:"large",options:[{value:"Todas",label:"Todas"},{value:"Disponible",label:"Disponibles"},{value:"Ocupada",label:"Ocupadas"},{value:"Reservada",label:"Reservadas"}],onChange:function(e){j(e[0])},placeholder:"Filtrar por..."})),i.a.createElement(u.a,null,f.map((function(e){return i.a.createElement(m.a,{lg:4,md:6,xs:8,key:e._id},i.a.createElement(k,{table:e,noMesa:e.noMesa,_id:e._id,deleteTable:_,editTablesRequest:D}))})),i.a.createElement(m.a,{lg:4,md:6,xs:8},i.a.createElement(T,{count:t.length,addTable:C})))),0===t.length&&i.a.createElement("div",{style:{margin:"0 auto",display:"block",top:250,position:"relative"}},i.a.createElement(g.a,{className:"big-size",spin:!0})))}}}]);
//# sourceMappingURL=24.701a3e3e.chunk.js.map